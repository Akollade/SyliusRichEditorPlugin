!function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/public/",i(i.s="ng4s")}({"2mad":function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},W4wD:function(e,t,i){e.exports=function(){"use strict";
/*!
   * mustache.js - Logic-less {{mustache}} templates with JavaScript
   * http://github.com/janl/mustache.js
   */var e=Object.prototype.toString,t=Array.isArray||function(t){return"[object Array]"===e.call(t)};function i(e){return"function"==typeof e}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function s(e,t){return null!=e&&"object"==typeof e&&t in e}var r=RegExp.prototype.test,o=/\S/;function l(e){return!function(e,t){return r.call(e,t)}(o,e)}var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},c=/\s*/,u=/\s+/,h=/\s*=/,d=/\s*\}/,g=/#|\^|\/|>|\{|&|=|!/;function p(e){this.string=e,this.tail=e,this.pos=0}function f(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function m(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}p.prototype.eos=function(){return""===this.tail},p.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var i=t[0];return this.tail=this.tail.substring(i.length),this.pos+=i.length,i},p.prototype.scanUntil=function(e){var t,i=this.tail.search(e);switch(i){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,i),this.tail=this.tail.substring(i)}return this.pos+=t.length,t},f.prototype.push=function(e){return new f(e,this)},f.prototype.lookup=function(e){var t,n,r,o=this.cache;if(o.hasOwnProperty(e))t=o[e];else{for(var l,a,c,u=this,h=!1;u;){if(e.indexOf(".")>0)for(l=u.view,a=e.split("."),c=0;null!=l&&c<a.length;)c===a.length-1&&(h=s(l,a[c])||(n=l,r=a[c],null!=n&&"object"!=typeof n&&n.hasOwnProperty&&n.hasOwnProperty(r))),l=l[a[c++]];else l=u.view[e],h=s(u.view,e);if(h){t=l;break}u=u.parent}o[e]=t}return i(t)&&(t=t.call(this.view)),t},m.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},m.prototype.parse=function(e,i){var s=this.templateCache,r=e+":"+(i||b.tags).join(":"),o=void 0!==s,a=o?s.get(r):void 0;return null==a&&(a=function(e,i){if(!e)return[];var s,r,o,a=!1,f=[],m=[],v=[],y=!1,E=!1,w="",S=0;function k(){if(y&&!E)for(;v.length;)delete m[v.pop()];else v=[];y=!1,E=!1}function C(e){if("string"==typeof e&&(e=e.split(u,2)),!t(e)||2!==e.length)throw new Error("Invalid tags: "+e);s=new RegExp(n(e[0])+"\\s*"),r=new RegExp("\\s*"+n(e[1])),o=new RegExp("\\s*"+n("}"+e[1]))}C(i||b.tags);for(var T,A,O,j,x,U,L=new p(e);!L.eos();){if(T=L.pos,O=L.scanUntil(s))for(var F=0,P=O.length;F<P;++F)l(j=O.charAt(F))?(v.push(m.length),w+=j):(E=!0,a=!0,w+=" "),m.push(["text",j,T,T+1]),T+=1,"\n"===j&&(k(),w="",S=0,a=!1);if(!L.scan(s))break;if(y=!0,A=L.scan(g)||"name",L.scan(c),"="===A?(O=L.scanUntil(h),L.scan(h),L.scanUntil(r)):"{"===A?(O=L.scanUntil(o),L.scan(d),L.scanUntil(r),A="&"):O=L.scanUntil(r),!L.scan(r))throw new Error("Unclosed tag at "+L.pos);if(x=">"==A?[A,O,T,L.pos,w,S,a]:[A,O,T,L.pos],S++,m.push(x),"#"===A||"^"===A)f.push(x);else if("/"===A){if(!(U=f.pop()))throw new Error('Unopened section "'+O+'" at '+T);if(U[1]!==O)throw new Error('Unclosed section "'+U[1]+'" at '+T)}else"name"===A||"{"===A||"&"===A?E=!0:"="===A&&C(O)}if(k(),U=f.pop())throw new Error('Unclosed section "'+U[1]+'" at '+L.pos);return function(e){for(var t,i=[],n=i,s=[],r=0,o=e.length;r<o;++r)switch((t=e[r])[0]){case"#":case"^":n.push(t),s.push(t),n=t[4]=[];break;case"/":s.pop()[5]=t[2],n=s.length>0?s[s.length-1][4]:i;break;default:n.push(t)}return i}(function(e){for(var t,i,n=[],s=0,r=e.length;s<r;++s)(t=e[s])&&("text"===t[0]&&i&&"text"===i[0]?(i[1]+=t[1],i[3]=t[3]):(n.push(t),i=t));return n}(m))}(e,i),o&&s.set(r,a)),a},m.prototype.render=function(e,t,i,n){var s=this.parse(e,n),r=t instanceof f?t:new f(t,void 0);return this.renderTokens(s,r,i,e,n)},m.prototype.renderTokens=function(e,t,i,n,s){for(var r,o,l,a="",c=0,u=e.length;c<u;++c)l=void 0,"#"===(o=(r=e[c])[0])?l=this.renderSection(r,t,i,n):"^"===o?l=this.renderInverted(r,t,i,n):">"===o?l=this.renderPartial(r,t,i,s):"&"===o?l=this.unescapedValue(r,t):"name"===o?l=this.escapedValue(r,t):"text"===o&&(l=this.rawValue(r)),void 0!==l&&(a+=l);return a},m.prototype.renderSection=function(e,n,s,r){var o=this,l="",a=n.lookup(e[1]);if(a){if(t(a))for(var c=0,u=a.length;c<u;++c)l+=this.renderTokens(e[4],n.push(a[c]),s,r);else if("object"==typeof a||"string"==typeof a||"number"==typeof a)l+=this.renderTokens(e[4],n.push(a),s,r);else if(i(a)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(a=a.call(n.view,r.slice(e[3],e[5]),(function(e){return o.render(e,n,s)})))&&(l+=a)}else l+=this.renderTokens(e[4],n,s,r);return l}},m.prototype.renderInverted=function(e,i,n,s){var r=i.lookup(e[1]);if(!r||t(r)&&0===r.length)return this.renderTokens(e[4],i,n,s)},m.prototype.indentPartial=function(e,t,i){for(var n=t.replace(/[^ \t]/g,""),s=e.split("\n"),r=0;r<s.length;r++)s[r].length&&(r>0||!i)&&(s[r]=n+s[r]);return s.join("\n")},m.prototype.renderPartial=function(e,t,n,s){if(n){var r=i(n)?n(e[1]):n[e[1]];if(null!=r){var o=e[6],l=e[5],a=e[4],c=r;return 0==l&&a&&(c=this.indentPartial(r,a,o)),this.renderTokens(this.parse(c,s),t,n,c,s)}}},m.prototype.unescapedValue=function(e,t){var i=t.lookup(e[1]);if(null!=i)return i},m.prototype.escapedValue=function(e,t){var i=t.lookup(e[1]);if(null!=i)return b.escape(i)},m.prototype.rawValue=function(e){return e[1]};var b={name:"mustache.js",version:"4.0.1",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){v.templateCache=e},get templateCache(){return v.templateCache}},v=new m;return b.clearCache=function(){return v.clearCache()},b.parse=function(e,t){return v.parse(e,t)},b.render=function(e,i,n,s){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(t(r=e)?"array":typeof r)+'" was given as the first argument for mustache#render(template, view, partials)');var r;return v.render(e,i,n,s)},b.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return a[e]}))},b.Scanner=p,b.Context=f,b.Writer=m,b}()},mf8f:function(e,t,i){"use strict";var n={documentSelector:".js-document",documentDisabledClass:"is-disabled",openingTriggerActiveClass:"is-active",delay:200},s=['[href]:not([tabindex^="-"])','input:not([disabled]):not([type="hidden"]):not([tabindex^="-"]):not([type="radio"])','input[type="radio"]:checked','select:not([disabled]):not([tabindex^="-"])','textarea:not([disabled]):not([tabindex^="-"])','button:not([disabled]):not([tabindex^="-"])','[tabindex]:not([tabindex^="-"])','[contenteditable="true"]:not([tabindex^="-"])'],r="Escape",o="Tab",l="F6";function a(e,t){let i=e;for(;i!==t&&i;)i=i.parentNode;return!!i}const c=Symbol("onClick"),u=Symbol("onKeydown"),h=Symbol("addEventDelegation"),d=Symbol("addEventListeners"),g=Symbol("removeEventListeners"),p=Symbol("addAttributes"),f=Symbol("removeAttributes"),m=Symbol("setAttributes"),b=Symbol("setFocusableElements"),v=Symbol("setFocus"),y=Symbol("restoreFocus"),E=Symbol("switchFocus"),w=Symbol("maintainFocus"),S=Symbol("addObserver"),k=Symbol("removeObserver");let C=n;t.a=class{constructor(e,{onOpen:t=(()=>{}),onClose:i=(()=>{}),openingSelector:n,closingSelector:s,backdropSelector:r,helperSelector:o,labelledby:l,describedby:a,isModal:d=!0,isTooltip:g=!1,isOpen:p=!1,isCreated:f=!0,disableScroll:m=!0,enableAutoFocus:v=!0,openingTriggerActiveClass:y=C.openingTriggerActiveClass,delay:w=C.delay}={}){document.querySelector(e)?(this.config={dialogSelector:e,onOpen:t,onClose:i,openingSelector:n,closingSelector:s,backdropSelector:r,helperSelector:o,labelledby:l,describedby:a,isModal:d,isTooltip:g,isCreated:f,isOpen:p,disableScroll:m,enableAutoFocus:v,documentSelector:C.documentSelector,documentDisabledClass:C.documentDisabledClass,openingTriggerActiveClass:y,delay:w},this.dialog=document.querySelector(e),this.dialogArea=`${e}, ${n}`,this.openingTriggers=document.querySelectorAll(n),this.backdropTrigger=document.querySelector(r),this.helpers=document.querySelectorAll(o),this.document=document.querySelector(this.config.documentSelector)||document.querySelector("html"),this.documentIsAlreadyDisabled=!1,this.focusableElements=[],this.firstFocusableElement=null,this.lastFocusableElement=null,this.openingTrigger=null,this.closingTrigger=null,this.isCreated=!1,this.isOpen=!1,this.close=this.close.bind(this),this.toggle=this.toggle.bind(this),this[c]=this[c].bind(this),this[u]=this[u].bind(this),this[h]=this[h].bind(this),this[E]=this[E].bind(this),this.observer=new MutationObserver(e=>e.forEach(()=>this[b]())),this.isInitialized=!0,f&&this.create()):this.isInitialized=!1}[c](e){this.config.isTooltip&&!e.target.closest(this.dialogArea)&&this.close(e),e.target===this.backdropTrigger&&this.close(e)}[u](e){switch(e.key){case r:e.stopPropagation(),this.close(e);break;case l:this.config.isModal||(this.config.isTooltip?this.close(e):this[y]());break;case o:this[w](e)}}[h](e){document.querySelectorAll(this.config.openingSelector).forEach(t=>{a(e.target,t)&&(this.openingTrigger=t,this.toggle(e))}),document.querySelectorAll(this.config.closingSelector).forEach(t=>{a(e.target,t)&&(this.closingTrigger=t,this.close())})}[d](){document.addEventListener("click",this[c],{capture:!0}),this.dialog.addEventListener("keydown",this[u])}[g](){document.removeEventListener("click",this[c],{capture:!0}),this.dialog.removeEventListener("keydown",this[u]),this.openingTrigger&&this.openingTrigger.removeEventListener("keydown",this[E])}[p](){this.dialog.setAttribute("role","dialog"),this.dialog.setAttribute("tabindex",-1),this.dialog.setAttribute("aria-hidden",!0),this.config.labelledby&&this.dialog.setAttribute("aria-labelledby",this.config.labelledby),this.config.describedby&&this.dialog.setAttribute("aria-describedby",this.config.describedby),this.config.isModal&&this.dialog.setAttribute("aria-modal",!0),this.openingTriggers.forEach(e=>e.setAttribute("aria-haspopup","dialog"))}[f](){this.dialog.removeAttribute("role"),this.dialog.removeAttribute("tabindex"),this.dialog.removeAttribute("aria-hidden"),this.dialog.removeAttribute("aria-labelledby"),this.dialog.removeAttribute("aria-describedby"),this.dialog.removeAttribute("aria-modal"),this.config.disableScroll&&this.isOpen&&!this.documentIsAlreadyDisabled&&this.document.classList.remove(this.config.documentDisabledClass),this.openingTriggers.forEach(e=>e.removeAttribute("aria-haspopup")),this.openingTrigger&&this.openingTrigger.classList.remove(this.config.openingTriggerActiveClass),this.helpers.forEach(e=>e.classList.remove(this.config.openingTriggerActiveClass))}[m](){this.dialog.setAttribute("aria-hidden",!this.isOpen),this.config.disableScroll&&!this.documentIsAlreadyDisabled&&(this.isOpen?this.document.classList.add(this.config.documentDisabledClass):this.document.classList.remove(this.config.documentDisabledClass)),this.openingTrigger&&(this.isOpen?this.openingTrigger.classList.add(this.config.openingTriggerActiveClass):this.openingTrigger.classList.remove(this.config.openingTriggerActiveClass)),this.helpers.forEach(e=>{this.isOpen?e.classList.add(this.config.openingTriggerActiveClass):e.classList.remove(this.config.openingTriggerActiveClass)})}[b](){const e=function(e){const t=[];return e.forEach(e=>{const i=e.getBoundingClientRect();(i.width>0||i.height>0)&&t.push(e)}),t}(this.dialog.querySelectorAll(s)),t=function(e,t,i){const n=e.querySelectorAll(t),s=[];let r=!1;return 0===n.length?i:(i.forEach(e=>{n.forEach(t=>{t.contains(e)&&(r=!0)}),r||s.push(e),r=!1}),s)}(this.dialog,'[role="dialog"]',e);this.focusableElements=t.length>0?t:[this.dialog],[this.firstFocusableElement]=this.focusableElements,this.lastFocusableElement=this.focusableElements[this.focusableElements.length-1]}[v](){this.config.enableAutoFocus&&window.setTimeout(()=>this.firstFocusableElement.focus(),this.config.delay)}[y](){this.config.enableAutoFocus&&window.setTimeout(()=>this.openingTrigger.focus(),this.config.delay),this.isOpen&&this.openingTrigger.addEventListener("keydown",this[E])}[E](e){e.key===l&&(this.openingTrigger.removeEventListener("keydown",this[E]),this[v]())}[w](e){e.shiftKey&&e.target===this.firstFocusableElement&&(e.preventDefault(),this.lastFocusableElement.focus()),e.shiftKey||e.target!==this.lastFocusableElement||(e.preventDefault(),this.firstFocusableElement.focus())}[S](){this.observer.observe(this.dialog,{childList:!0,attributes:!0,subtree:!0})}[k](){this.observer.disconnect()}open(){this.isInitialized&&this.isCreated&&!this.isOpen&&(this.isOpen=!0,this.documentIsAlreadyDisabled=this.document.classList.contains(this.config.documentDisabledClass),this[m](),this[d](),this[v](),this.config.onOpen(this.dialog,this.openingTrigger))}close(e){this.isInitialized&&this.isCreated&&this.isOpen&&(this.isOpen=!1,e&&e.preventDefault(),this[m](),this[g](),this.openingTrigger&&(!this.config.isTooltip||this.config.isTooltip&&e&&"click"!==e.type)&&this[y](),this.config.onClose(this.dialog,this.closingTrigger))}toggle(e){this.isInitialized&&this.isCreated&&(e&&e.preventDefault(),this.isOpen?this.close():this.open())}create(){this.isInitialized&&!this.isCreated&&(this.isCreated=!0,this[p](),this[b](),this[S](),this.config.isOpen&&this.open(),document.addEventListener("click",this[h],{capture:!0}))}destroy(){this.isInitialized&&this.isCreated&&(this.close(),this.isCreated=!1,this[f](),this[g](),this[k](),document.removeEventListener("click",this[h],{capture:!0}))}}},ng4s:function(e,t,i){"use strict";i.r(t),function(e){var t=i("mf8f"),n=i("W4wD"),s=i.n(n);function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),e}e.MonsieurBizRichEditorConfig=function(){function e(t,i,n,s,o,l,a,c,u){r(this,e),this.input=t,this.uielements=i,this.containerHtml=n,this.buttonAddHtml=s,this.elementHtml=o,this.elementCardHtml=l,this.deletionConfirmation=a,this.createElementFormUrl=c,this.editElementFormUrl=u}return l(e,[{key:"findUiElementByCode",value:function(e){return void 0===this.uielements[e]?null:this.uielements[e]}}]),e}(),e.MonsieurBizRichEditorUiElement=function(){function e(t,i,n){r(this,e),this.config=t,this.code=i,this.data=n}return l(e,[{key:"toJSON",value:function(){return{code:this.code,data:this.data}}},{key:"up",value:function(){this.manager.moveUp(this)}},{key:"down",value:function(){this.manager.moveDown(this)}},{key:"delete",value:function(){this.manager.delete(this)}},{key:"uielement",get:function(){return this.config.findUiElementByCode(this.code)}},{key:"title",get:function(){return this.uielement.title}},{key:"description",get:function(){return this.uielement.description}},{key:"icon",get:function(){return this.uielement.icon}},{key:"manager",get:function(){return this.config.input.manager}}]),e}(),e.MonsieurBizRichEditorManager=function(){function e(t){r(this,e),this.config=t;try{this.initUiElements(JSON.parse(this.input.value.trim()))}catch(e){this.uiElements=[]}this.initInterface()}return l(e,[{key:"initUiElements",value:function(e){this.uiElements=[],e.forEach(function(e){null!==this.config.findUiElementByCode(e.code)&&this.uiElements.push(new MonsieurBizRichEditorUiElement(this.config,e.code,e.data))}.bind(this))}},{key:"initInterface",value:function(){this.initUiElementsInterface(),this.initUiPanelsInterface()}},{key:"initUiPanelsInterface",value:function(){this.selectionPanel=new t.a(".js-uie-panels",{backdropSelector:".js-uie-panels",labelledby:"uie-heading",enableAutoFocus:!1}),this.newPanel=new t.a(".js-uie-panels-new",{backdropSelector:".js-uie-panels-new",helperSelector:".js-uie-panels-selector",enableAutoFocus:!1}),this.editPanel=new t.a(".js-uie-panels-edit",{backdropSelector:".js-uie-panels-edit",enableAutoFocus:!1})}},{key:"initUiElementsInterface",value:function(){this.input.type="hidden";var e=document.createElement("div");e.innerHTML=s.a.render(this.config.containerHtml,{}),this.container=e.firstElementChild,this.input.after(this.container),this.drawUiElements()}},{key:"drawUiElements",value:function(){var e=[];this.uiElements.forEach(function(t,i){e.push(this.getNewButton(i)),e.push(this.getUiElement(t,i))}.bind(this));var t=this.container.querySelector(".js-uie-container");t.innerHTML="",e.forEach((function(e){t.append(e)})),t.append(this.getNewButton(this.uiElements.length))}},{key:"getNewButton",value:function(e){var t=document.createElement("div");t.innerHTML=s.a.render(this.config.buttonAddHtml,{position:e});var i=t.firstElementChild;return i.querySelector(".js-uie-add").position=e,i.querySelector(".js-uie-add").manager=this,i.querySelector(".js-uie-add").addEventListener("click",(function(e){i.querySelector(".js-uie-add").manager.openSelectionPanel(i.querySelector(".js-uie-add").position)})),i}},{key:"getUiElement",value:function(e,t){var i=document.createElement("div");i.innerHTML=s.a.render(this.config.elementHtml,{title:e.title});var n=i.firstElementChild;return n.element=e,n.position=t,n.querySelector(".js-uie-delete").addEventListener("click",(function(){confirm(this.closest(".js-uie-element").element.config.deletionConfirmation)&&this.closest(".js-uie-element").element.delete()})),n.querySelector(".js-uie-up").addEventListener("click",(function(){this.closest(".js-uie-element").element.up()})),n.querySelector(".js-uie-down").addEventListener("click",(function(){this.closest(".js-uie-element").element.down()})),n}},{key:"getNewUiElementCard",value:function(e,t){var i=document.createElement("div");i.innerHTML=s.a.render(this.config.elementCardHtml,e);var n=i.firstElementChild;return n.element=e,n.position=t,n.manager=this,n.addEventListener("click",(function(e){console.log(e.currentTarget.manager),console.log(e.currentTarget.element),console.log(e.currentTarget.position)})),n}},{key:"openSelectionPanel",value:function(e){this.selectionPanel.dialog.manager=this,this.selectionPanel.dialog.position=e;var t=this.selectionPanel.dialog.querySelector(".js-uie-cards-container");for(var i in t.innerHTML="",this.config.uielements)t.append(this.getNewUiElementCard(this.config.uielements[i],e));this.selectionPanel.open()}},{key:"write",value:function(){this.input.value=JSON.stringify(this.uiElements),this.drawUiElements()}},{key:"create",value:function(e,t){var i=new MonsieurBizRichEditorUiElement(this.config,e,{});return this.uiElements.splice(t,0,i),this.write(),i}},{key:"moveUp",value:function(e){var t=this.uiElements.indexOf(e);0!==t&&(this.uiElements.splice(t,1),this.uiElements.splice(t-1,0,e),this.write())}},{key:"moveDown",value:function(e){var t=this.uiElements.indexOf(e);t!==this.uiElements.length-1&&(this.uiElements.splice(t,1),this.uiElements.splice(t+1,0,e),this.write())}},{key:"delete",value:function(e){var t=this.uiElements.indexOf(e);this.uiElements.splice(t,1),this.write()}},{key:"input",get:function(){return this.config.input}}]),e}()}.call(this,i("2mad"))}});