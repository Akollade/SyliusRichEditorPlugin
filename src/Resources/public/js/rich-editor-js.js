/*! For license information please see rich-editor-js.js.LICENSE.txt */
(()=>{var e={170:function(e,t){!function(e){"use strict";var t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},i="defaultParagraphSeparator",n="formatBlock",r=function(e,t,i){return e.addEventListener(t,i)},s=function(e,t){return e.appendChild(t)},o=function(e){return document.createElement(e)},a=function(e){return document.queryCommandState(e)},l=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return document.execCommand(e,!1,t)},c={bold:{icon:"<b>B</b>",title:"Bold",state:function(){return a("bold")},result:function(){return l("bold")}},italic:{icon:"<i>I</i>",title:"Italic",state:function(){return a("italic")},result:function(){return l("italic")}},underline:{icon:"<u>U</u>",title:"Underline",state:function(){return a("underline")},result:function(){return l("underline")}},strikethrough:{icon:"<strike>S</strike>",title:"Strike-through",state:function(){return a("strikeThrough")},result:function(){return l("strikeThrough")}},heading1:{icon:"<b>H<sub>1</sub></b>",title:"Heading 1",result:function(){return l(n,"<h1>")}},heading2:{icon:"<b>H<sub>2</sub></b>",title:"Heading 2",result:function(){return l(n,"<h2>")}},paragraph:{icon:"&#182;",title:"Paragraph",result:function(){return l(n,"<p>")}},quote:{icon:"&#8220; &#8221;",title:"Quote",result:function(){return l(n,"<blockquote>")}},olist:{icon:"&#35;",title:"Ordered List",result:function(){return l("insertOrderedList")}},ulist:{icon:"&#8226;",title:"Unordered List",result:function(){return l("insertUnorderedList")}},code:{icon:"&lt;/&gt;",title:"Code",result:function(){return l(n,"<pre>")}},line:{icon:"&#8213;",title:"Horizontal Line",result:function(){return l("insertHorizontalRule")}},link:{icon:"&#128279;",title:"Link",result:function(){var e=window.prompt("Enter the link URL");e&&l("createLink",e)}},image:{icon:"&#128247;",title:"Image",result:function(){var e=window.prompt("Enter the image URL");e&&l("insertImage",e)}}},u={actionbar:"pell-actionbar",button:"pell-button",content:"pell-content",selected:"pell-button-selected"},d=function(e){var a=e.actions?e.actions.map((function(e){return"string"==typeof e?c[e]:c[e.name]?t({},c[e.name],e):e})):Object.keys(c).map((function(e){return c[e]})),d=t({},u,e.classes),h=e[i]||"div",f=o("div");f.className=d.actionbar,s(e.element,f);var p=e.element.content=o("div");return p.contentEditable=!0,p.className=d.content,p.oninput=function(t){var i=t.target.firstChild;i&&3===i.nodeType?l(n,"<"+h+">"):"<br>"===p.innerHTML&&(p.innerHTML=""),e.onChange(p.innerHTML)},p.onkeydown=function(e){var t;"Enter"===e.key&&"blockquote"===(t=n,document.queryCommandValue(t))&&setTimeout((function(){return l(n,"<"+h+">")}),0)},s(e.element,p),a.forEach((function(e){var t=o("button");if(t.className=d.button,t.innerHTML=e.icon,t.title=e.title,t.setAttribute("type","button"),t.onclick=function(){return e.result()&&p.focus()},e.state){var i=function(){return t.classList[e.state()?"add":"remove"](d.selected)};r(p,"keyup",i),r(p,"mouseup",i),r(t,"click",i)}s(f,t)})),e.styleWithCSS&&l("styleWithCSS"),l(i,h),e.element},h={exec:l,init:d};e.exec=l,e.init=d,e.default=h,Object.defineProperty(e,"__esModule",{value:!0})}(t)}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,i),s.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=i(170),t=i.n(e),n={documentSelector:".js-document",documentDisabledClass:"is-disabled",openingTriggerActiveClass:"is-active",delay:200},r=['[href]:not([tabindex^="-"])','input:not([disabled]):not([type="hidden"]):not([tabindex^="-"]):not([type="radio"])','input[type="radio"]:checked','select:not([disabled]):not([tabindex^="-"])','textarea:not([disabled]):not([tabindex^="-"])','button:not([disabled]):not([tabindex^="-"])','[tabindex]:not([tabindex^="-"])','[contenteditable="true"]:not([tabindex^="-"])'],s="Escape",o="Tab",a="F6";function l(e,t){let i=e;for(;i!==t&&i;)i=i.parentNode;return!!i}const c=Symbol("onClick"),u=Symbol("onKeydown"),d=Symbol("addEventDelegation"),h=Symbol("addEventListeners"),f=Symbol("removeEventListeners"),p=Symbol("addAttributes"),m=Symbol("removeAttributes"),g=Symbol("setAttributes"),v=Symbol("setFocusableElements"),y=Symbol("setFocus"),b=Symbol("restoreFocus"),E=Symbol("switchFocus"),w=Symbol("maintainFocus"),S=Symbol("addObserver"),k=Symbol("removeObserver");let C=n;const T=class{constructor(e,{onOpen:t=(()=>{}),onClose:i=(()=>{}),openingSelector:n,closingSelector:r,backdropSelector:s,helperSelector:o,labelledby:a,describedby:l,isModal:h=!0,isTooltip:f=!1,isOpen:p=!1,isCreated:m=!0,disableScroll:g=!0,enableAutoFocus:y=!0,openingTriggerActiveClass:b=C.openingTriggerActiveClass,delay:w=C.delay}={}){document.querySelector(e)?(this.config={dialogSelector:e,onOpen:t,onClose:i,openingSelector:n,closingSelector:r,backdropSelector:s,helperSelector:o,labelledby:a,describedby:l,isModal:h,isTooltip:f,isCreated:m,isOpen:p,disableScroll:g,enableAutoFocus:y,documentSelector:C.documentSelector,documentDisabledClass:C.documentDisabledClass,openingTriggerActiveClass:b,delay:w},this.dialog=document.querySelector(e),this.dialogArea=`${e}, ${n}`,this.openingTriggers=document.querySelectorAll(n),this.backdropTrigger=document.querySelector(s),this.helpers=document.querySelectorAll(o),this.document=document.querySelector(this.config.documentSelector)||document.querySelector("html"),this.documentIsAlreadyDisabled=!1,this.focusableElements=[],this.firstFocusableElement=null,this.lastFocusableElement=null,this.openingTrigger=null,this.closingTrigger=null,this.isCreated=!1,this.isOpen=!1,this.close=this.close.bind(this),this.toggle=this.toggle.bind(this),this[c]=this[c].bind(this),this[u]=this[u].bind(this),this[d]=this[d].bind(this),this[E]=this[E].bind(this),this.observer=new MutationObserver((e=>e.forEach((()=>this[v]())))),this.isInitialized=!0,m&&this.create()):this.isInitialized=!1}[c](e){this.config.isTooltip&&!e.target.closest(this.dialogArea)&&this.close(e),e.target===this.backdropTrigger&&this.close(e)}[u](e){switch(e.key){case s:e.stopPropagation(),this.close(e);break;case a:this.config.isModal||(this.config.isTooltip?this.close(e):this[b]());break;case o:this[w](e)}}[d](e){document.querySelectorAll(this.config.openingSelector).forEach((t=>{l(e.target,t)&&(this.openingTrigger=t,this.toggle(e))})),document.querySelectorAll(this.config.closingSelector).forEach((t=>{l(e.target,t)&&(this.closingTrigger=t,this.close())}))}[h](){document.addEventListener("click",this[c],{capture:!0}),this.dialog.addEventListener("keydown",this[u])}[f](){document.removeEventListener("click",this[c],{capture:!0}),this.dialog.removeEventListener("keydown",this[u]),this.openingTrigger&&this.openingTrigger.removeEventListener("keydown",this[E])}[p](){this.dialog.setAttribute("role","dialog"),this.dialog.setAttribute("tabindex",-1),this.dialog.setAttribute("aria-hidden",!0),this.config.labelledby&&this.dialog.setAttribute("aria-labelledby",this.config.labelledby),this.config.describedby&&this.dialog.setAttribute("aria-describedby",this.config.describedby),this.config.isModal&&this.dialog.setAttribute("aria-modal",!0),this.openingTriggers.forEach((e=>e.setAttribute("aria-haspopup","dialog")))}[m](){this.dialog.removeAttribute("role"),this.dialog.removeAttribute("tabindex"),this.dialog.removeAttribute("aria-hidden"),this.dialog.removeAttribute("aria-labelledby"),this.dialog.removeAttribute("aria-describedby"),this.dialog.removeAttribute("aria-modal"),this.config.disableScroll&&this.isOpen&&!this.documentIsAlreadyDisabled&&this.document.classList.remove(this.config.documentDisabledClass),this.openingTriggers.forEach((e=>e.removeAttribute("aria-haspopup"))),this.openingTrigger&&this.openingTrigger.classList.remove(this.config.openingTriggerActiveClass),this.helpers.forEach((e=>e.classList.remove(this.config.openingTriggerActiveClass)))}[g](){this.dialog.setAttribute("aria-hidden",!this.isOpen),this.config.disableScroll&&!this.documentIsAlreadyDisabled&&(this.isOpen?this.document.classList.add(this.config.documentDisabledClass):this.document.classList.remove(this.config.documentDisabledClass)),this.openingTrigger&&(this.isOpen?this.openingTrigger.classList.add(this.config.openingTriggerActiveClass):this.openingTrigger.classList.remove(this.config.openingTriggerActiveClass)),this.helpers.forEach((e=>{this.isOpen?e.classList.add(this.config.openingTriggerActiveClass):e.classList.remove(this.config.openingTriggerActiveClass)}))}[v](){const e=function(e){const t=[];return e.forEach((e=>{const i=e.getBoundingClientRect();(i.width>0||i.height>0)&&t.push(e)})),t}(this.dialog.querySelectorAll(r)),t=function(e,t,i){const n=e.querySelectorAll(t),r=[];let s=!1;return 0===n.length?i:(i.forEach((e=>{n.forEach((t=>{t.contains(e)&&(s=!0)})),s||r.push(e),s=!1})),r)}(this.dialog,'[role="dialog"]',e);this.focusableElements=t.length>0?t:[this.dialog],[this.firstFocusableElement]=this.focusableElements,this.lastFocusableElement=this.focusableElements[this.focusableElements.length-1]}[y](){this.config.enableAutoFocus&&window.setTimeout((()=>this.firstFocusableElement.focus()),this.config.delay)}[b](){this.config.enableAutoFocus&&window.setTimeout((()=>this.openingTrigger.focus()),this.config.delay),this.isOpen&&this.openingTrigger.addEventListener("keydown",this[E])}[E](e){e.key===a&&(this.openingTrigger.removeEventListener("keydown",this[E]),this[y]())}[w](e){e.shiftKey&&e.target===this.firstFocusableElement&&(e.preventDefault(),this.lastFocusableElement.focus()),e.shiftKey||e.target!==this.lastFocusableElement||(e.preventDefault(),this.firstFocusableElement.focus())}[S](){this.observer.observe(this.dialog,{childList:!0,attributes:!0,subtree:!0})}[k](){this.observer.disconnect()}open(){this.isInitialized&&this.isCreated&&!this.isOpen&&(this.isOpen=!0,this.documentIsAlreadyDisabled=this.document.classList.contains(this.config.documentDisabledClass),this[g](),this[h](),this[y](),this.config.onOpen(this.dialog,this.openingTrigger))}close(e){this.isInitialized&&this.isCreated&&this.isOpen&&(this.isOpen=!1,e&&e.preventDefault(),this[g](),this[f](),this.openingTrigger&&(!this.config.isTooltip||this.config.isTooltip&&e&&"click"!==e.type)&&this[b](),this.config.onClose(this.dialog,this.closingTrigger))}toggle(e){this.isInitialized&&this.isCreated&&(e&&e.preventDefault(),this.isOpen?this.close():this.open())}create(){this.isInitialized&&!this.isCreated&&(this.isCreated=!0,this[p](),this[v](),this[S](),this.config.isOpen&&this.open(),document.addEventListener("click",this[d],{capture:!0}))}destroy(){this.isInitialized&&this.isCreated&&(this.close(),this.isCreated=!1,this[m](),this[f](),this[k](),document.removeEventListener("click",this[d],{capture:!0}))}};var L=Object.prototype.toString,U=Array.isArray||function(e){return"[object Array]"===L.call(e)};function q(e){return"function"==typeof e}function A(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function j(e,t){return null!=e&&"object"==typeof e&&t in e}var O=RegExp.prototype.test;var x=/\S/;function H(e){return!function(e,t){return O.call(e,t)}(x,e)}var P={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var F=/\s*/,M=/\s+/,I=/\s*=/,R=/\s*\}/,D=/#|\^|\/|>|\{|&|=|!/;function N(e){this.string=e,this.tail=e,this.pos=0}function z(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function _(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}N.prototype.eos=function(){return""===this.tail},N.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var i=t[0];return this.tail=this.tail.substring(i.length),this.pos+=i.length,i},N.prototype.scanUntil=function(e){var t,i=this.tail.search(e);switch(i){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,i),this.tail=this.tail.substring(i)}return this.pos+=t.length,t},z.prototype.push=function(e){return new z(e,this)},z.prototype.lookup=function(e){var t,i,n,r=this.cache;if(r.hasOwnProperty(e))t=r[e];else{for(var s,o,a,l=this,c=!1;l;){if(e.indexOf(".")>0)for(s=l.view,o=e.split("."),a=0;null!=s&&a<o.length;)a===o.length-1&&(c=j(s,o[a])||(i=s,n=o[a],null!=i&&"object"!=typeof i&&i.hasOwnProperty&&i.hasOwnProperty(n))),s=s[o[a++]];else s=l.view[e],c=j(l.view,e);if(c){t=s;break}l=l.parent}r[e]=t}return q(t)&&(t=t.call(this.view)),t},_.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},_.prototype.parse=function(e,t){var i=this.templateCache,n=e+":"+(t||B.tags).join(":"),r=void 0!==i,s=r?i.get(n):void 0;return null==s&&(s=function(e,t){if(!e)return[];var i,n,r,s=!1,o=[],a=[],l=[],c=!1,u=!1,d="",h=0;function f(){if(c&&!u)for(;l.length;)delete a[l.pop()];else l=[];c=!1,u=!1}function p(e){if("string"==typeof e&&(e=e.split(M,2)),!U(e)||2!==e.length)throw new Error("Invalid tags: "+e);i=new RegExp(A(e[0])+"\\s*"),n=new RegExp("\\s*"+A(e[1])),r=new RegExp("\\s*"+A("}"+e[1]))}p(t||B.tags);for(var m,g,v,y,b,E,w=new N(e);!w.eos();){if(m=w.pos,v=w.scanUntil(i))for(var S=0,k=v.length;S<k;++S)H(y=v.charAt(S))?(l.push(a.length),d+=y):(u=!0,s=!0,d+=" "),a.push(["text",y,m,m+1]),m+=1,"\n"===y&&(f(),d="",h=0,s=!1);if(!w.scan(i))break;if(c=!0,g=w.scan(D)||"name",w.scan(F),"="===g?(v=w.scanUntil(I),w.scan(I),w.scanUntil(n)):"{"===g?(v=w.scanUntil(r),w.scan(R),w.scanUntil(n),g="&"):v=w.scanUntil(n),!w.scan(n))throw new Error("Unclosed tag at "+w.pos);if(b=">"==g?[g,v,m,w.pos,d,h,s]:[g,v,m,w.pos],h++,a.push(b),"#"===g||"^"===g)o.push(b);else if("/"===g){if(!(E=o.pop()))throw new Error('Unopened section "'+v+'" at '+m);if(E[1]!==v)throw new Error('Unclosed section "'+E[1]+'" at '+m)}else"name"===g||"{"===g||"&"===g?u=!0:"="===g&&p(v)}if(f(),E=o.pop())throw new Error('Unclosed section "'+E[1]+'" at '+w.pos);return function(e){for(var t,i=[],n=i,r=[],s=0,o=e.length;s<o;++s)switch((t=e[s])[0]){case"#":case"^":n.push(t),r.push(t),n=t[4]=[];break;case"/":r.pop()[5]=t[2],n=r.length>0?r[r.length-1][4]:i;break;default:n.push(t)}return i}(function(e){for(var t,i,n=[],r=0,s=e.length;r<s;++r)(t=e[r])&&("text"===t[0]&&i&&"text"===i[0]?(i[1]+=t[1],i[3]=t[3]):(n.push(t),i=t));return n}(a))}(e,t),r&&i.set(n,s)),s},_.prototype.render=function(e,t,i,n){var r=this.getConfigTags(n),s=this.parse(e,r),o=t instanceof z?t:new z(t,void 0);return this.renderTokens(s,o,i,e,n)},_.prototype.renderTokens=function(e,t,i,n,r){for(var s,o,a,l="",c=0,u=e.length;c<u;++c)a=void 0,"#"===(o=(s=e[c])[0])?a=this.renderSection(s,t,i,n,r):"^"===o?a=this.renderInverted(s,t,i,n,r):">"===o?a=this.renderPartial(s,t,i,r):"&"===o?a=this.unescapedValue(s,t):"name"===o?a=this.escapedValue(s,t,r):"text"===o&&(a=this.rawValue(s)),void 0!==a&&(l+=a);return l},_.prototype.renderSection=function(e,t,i,n,r){var s=this,o="",a=t.lookup(e[1]);if(a){if(U(a))for(var l=0,c=a.length;l<c;++l)o+=this.renderTokens(e[4],t.push(a[l]),i,n,r);else if("object"==typeof a||"string"==typeof a||"number"==typeof a)o+=this.renderTokens(e[4],t.push(a),i,n,r);else if(q(a)){if("string"!=typeof n)throw new Error("Cannot use higher-order sections without the original template");null!=(a=a.call(t.view,n.slice(e[3],e[5]),(function(e){return s.render(e,t,i,r)})))&&(o+=a)}else o+=this.renderTokens(e[4],t,i,n,r);return o}},_.prototype.renderInverted=function(e,t,i,n,r){var s=t.lookup(e[1]);if(!s||U(s)&&0===s.length)return this.renderTokens(e[4],t,i,n,r)},_.prototype.indentPartial=function(e,t,i){for(var n=t.replace(/[^ \t]/g,""),r=e.split("\n"),s=0;s<r.length;s++)r[s].length&&(s>0||!i)&&(r[s]=n+r[s]);return r.join("\n")},_.prototype.renderPartial=function(e,t,i,n){if(i){var r=this.getConfigTags(n),s=q(i)?i(e[1]):i[e[1]];if(null!=s){var o=e[6],a=e[5],l=e[4],c=s;0==a&&l&&(c=this.indentPartial(s,l,o));var u=this.parse(c,r);return this.renderTokens(u,t,i,c,n)}}},_.prototype.unescapedValue=function(e,t){var i=t.lookup(e[1]);if(null!=i)return i},_.prototype.escapedValue=function(e,t,i){var n=this.getConfigEscape(i)||B.escape,r=t.lookup(e[1]);if(null!=r)return"number"==typeof r&&n===B.escape?String(r):n(r)},_.prototype.rawValue=function(e){return e[1]},_.prototype.getConfigTags=function(e){return U(e)?e:e&&"object"==typeof e?e.tags:void 0},_.prototype.getConfigEscape=function(e){return e&&"object"==typeof e&&!U(e)?e.escape:void 0};var B={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){J.templateCache=e},get templateCache(){return J.templateCache}},J=new _;B.clearCache=function(){return J.clearCache()},B.parse=function(e,t){return J.parse(e,t)},B.render=function(e,t,i,n){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+((U(r=e)?"array":typeof r)+'" was given as the first argument for mustache#render(template, view, partials)'));var r;return J.render(e,t,i,n)},B.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return P[e]}))},B.Scanner=N,B.Context=z,B.Writer=_;const X=B;function W(e){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(e)}function V(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return $(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return $(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==i.return||i.return()}finally{if(a)throw s}}}}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Y(n.key),n)}}function G(e,t,i){return t&&Q(e.prototype,t),i&&Q(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y(e){var t=function(e,t){if("object"!=W(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=W(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==W(t)?t:t+""}i.g.MonsieurBizRichEditorWysiwyg=function(){return G((function e(t){K(this,e),this.config=t}),[{key:"exec",value:function(){return t().exec.apply(t(),arguments)}},{key:"load",value:function(e){var t,i=V(e.querySelectorAll("textarea.wysiwyg-enabled"));try{for(i.s();!(t=i.n()).done;){var n=t.value;this.setupEditor(n)}}catch(e){i.e(e)}finally{i.f()}}},{key:"setupEditor",value:function(e){e.setAttribute("hidden","true");var i=document.createElement("div");i.classList.add("pell"),e.parentNode.appendChild(i);var n=t().init({element:i,onChange:function(t){e.textContent=t},defaultParagraphSeparator:"p",actions:this.config.actions});n.addEventListener("paste",(function(e){e.stopPropagation(),e.preventDefault();var i=document.createElement("div"),n=e.clipboardData||window.clipboardData;i.innerHTML=n.getData("Text");var r=i.textContent||i.innerText||"";return t().exec("insertText",r),!0}));var r=e.value;n.content.innerHTML=r}}])}(),i.g.MonsieurBizRichEditorConfig=function(){return G((function e(t,i,n,r,s,o,a,l,c,u,d,h,f,p,m,g,v){K(this,e),this.input=t,this.uielements=i,this.wysiwyg=n,this.containerHtml=r,this.actionsHtml=s,this.elementHtml=o,this.elementCardHtml=a,this.panelsHtml=l,this.panelsEditHtml=c,this.deletionConfirmation=u,this.createElementFormUrl=d,this.editElementFormUrl=h,this.renderElementsUrl=f,this.defaultUiElement=p,this.defaultUIElementDataField=m,this.errorMessage=g,this.unallowedUiElementMessage=v,this.uid=Math.random().toString(36).substring(2,11)}),[{key:"findUiElementByCode",value:function(e){return void 0===this.uielements[e]?null:this.uielements[e]}}])}(),i.g.MonsieurBizRichEditorUiElement=function(){return G((function e(t,i,n,r){K(this,e),this.config=t,this.code=i,this.data=n,this.previewHtml=r}),[{key:"toJSON",value:function(){return{code:this.code,data:this.data}}},{key:"uielement",get:function(){return this.config.findUiElementByCode(this.code)}},{key:"enabled",get:function(){return this.uielement.enabled}},{key:"title",get:function(){return this.uielement.title}},{key:"description",get:function(){return this.uielement.description}},{key:"icon",get:function(){return this.uielement.icon}},{key:"manager",get:function(){return this.config.input.manager}},{key:"edit",value:function(){this.manager.editUiElement(this)}},{key:"copy",value:function(e){this.manager.saveUiElementToClipboard(this,e)}},{key:"up",value:function(){this.manager.moveUp(this)}},{key:"down",value:function(){this.manager.moveDown(this)}},{key:"delete",value:function(){this.manager.delete(this)}}])}(),i.g.MonsieurBizRichEditorManager=function(){return G((function e(t,i){K(this,e),t.input.setAttribute("data-rich-editor-uid",t.uid),this.config=t;var n=this.input.value.trim();this.tags=i,this.tagsAreExclusive=!1;var r,s=V(this.tags);try{for(s.s();!(r=s.n()).done;){if(!r.value.startsWith("-")){this.tagsAreExclusive=!0;break}}}catch(e){s.e(e)}finally{s.f()}var o,a,l,c=function(){this.initInterface()}.bind(this);if(""!==n)try{this.initUiElements(JSON.parse(n),c)}catch(e){this.initUiElements([{code:this.config.defaultUiElement,data:(o={},a=this.config.defaultUIElementDataField,l=n,(a=Y(a))in o?Object.defineProperty(o,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):o[a]=l,o)}],c)}else this.uiElements=[],this.initInterface()}),[{key:"initUiElements",value:function(e,t){this.uiElements=[],this.requestUiElementsHtml(e,(function(){200===this.status&&(JSON.parse(this.responseText).forEach(function(t,i){var n=e[i];void 0===n.code&&void 0!==n.type&&(n.code=n.type,n.data=n.fields,delete n.type,delete n.fields);var r=this.config.findUiElementByCode(n.code);null!==r&&this.uiElements.push(new MonsieurBizRichEditorUiElement(this.config,r.code,n.data,t))}.bind(this.manager)),t())}))}},{key:"initInterface",value:function(){this.initUiElementsInterface(),this.initUiPanelsInterface(),document.dispatchEvent(new CustomEvent("mbiz:rich-editor:init-interface-complete",{detail:{editorManager:this}})),document.addEventListener("mbiz:rich-editor:uielement:copied",function(e){this.container.querySelectorAll(".js-uie-paste").forEach(function(e){e.classList.remove("disabled")}.bind(this))}.bind(this))}},{key:"initUiPanelsInterface",value:function(){var e=document.createElement("div");e.innerHTML=X.render(this.config.panelsHtml,{uid:this.config.uid}),document.body.appendChild(e.firstElementChild);var t=document.createElement("div");t.innerHTML=X.render(this.config.panelsEditHtml,{uid:this.config.uid}),document.body.appendChild(t.firstElementChild),this.selectionPanel=new T(".js-uie-panels-"+this.config.uid,{labelledby:"uie-heading-"+this.config.uid,enableAutoFocus:!1,closingSelector:".js-uie-panels-close-"+this.config.uid}),this.newPanel=new T(".js-uie-panels-new-"+this.config.uid,{helperSelector:".js-uie-panels-selector-"+this.config.uid,enableAutoFocus:!1}),this.editPanel=new T(".js-uie-panels-edit-"+this.config.uid,{enableAutoFocus:!1})}},{key:"initUiElementsInterface",value:function(){this.input.type="hidden";var e=document.createElement("div");e.innerHTML=X.render(this.config.containerHtml,{}),this.container=e.firstElementChild,this.input.after(this.container),this.write()}},{key:"drawUiElements",value:function(){var e=this.container.querySelector(".js-uie-container");e.innerHTML="",this.uiElements.forEach(function(t,i){e.append(this.getActions(i)),e.append(this.getUiElement(t,i))}.bind(this)),e.append(this.getActions(this.uiElements.length))}},{key:"getActions",value:function(e){var t=document.createElement("div");t.innerHTML=X.render(this.config.actionsHtml,{position:e});var i=t.firstElementChild;return i.querySelector(".js-uie-add").position=e,i.querySelector(".js-uie-add").manager=this,i.querySelector(".js-uie-add").addEventListener("click",(function(e){i.querySelector(".js-uie-add").manager.openSelectionPanel(i.querySelector(".js-uie-add").position)})),i.querySelector(".js-uie-paste").position=e,i.querySelector(".js-uie-paste").manager=this,i.querySelector(".js-uie-paste").addEventListener("click",(function(e){i.querySelector(".js-uie-paste").manager.pasteUiElementFromClipboard(i.querySelector(".js-uie-paste").position)})),this.isClipboardEmpty()||i.querySelector(".js-uie-paste").classList.remove("disabled"),i}},{key:"getUiElement",value:function(e,t){var i=document.createElement("div");i.innerHTML=X.render(this.config.elementHtml,{title:e.title,icon:e.icon,preview:e.previewHtml,disabled:!e.enabled});var n=i.firstElementChild;return n.element=e,n.position=t,n.querySelector(".js-uie-delete").addEventListener("click",(function(){confirm(this.closest(".js-uie-element").element.config.deletionConfirmation)&&this.closest(".js-uie-element").element.delete()})),0===t?n.querySelector(".js-uie-up").remove():n.querySelector(".js-uie-up").addEventListener("click",(function(){this.closest(".js-uie-element").element.up()})),t===this.uiElements.length-1?n.querySelector(".js-uie-down").remove():n.querySelector(".js-uie-down").addEventListener("click",(function(){this.closest(".js-uie-element").element.down()})),n.querySelector(".js-uie-edit").addEventListener("click",(function(){this.closest(".js-uie-element").element.edit()})),n.querySelector(".js-uie-copy").addEventListener("click",(function(e){this.closest(".js-uie-element").element.copy((function(){var t=e.currentTarget,i=t.dataset.tooltip;t.dataset.tooltip=t.dataset.alternateText,window.setTimeout((function(){t.dataset.tooltip=i}),1e3)}))})),n}},{key:"getNewUiElementCard",value:function(e,t){var i=document.createElement("div");i.innerHTML=X.render(this.config.elementCardHtml,e);var n=i.firstElementChild;return n.element=e,n.position=t,n.manager=this,n.addEventListener("click",(function(e){var t=e.currentTarget;t.manager.loadUiElementCreateForm(t.element,(function(e){if(200===this.status){var i=JSON.parse(this.responseText);t.manager.openNewPanel(i.form_html,t.element,t.position)}}))})),n}},{key:"input",get:function(){return this.config.input}},{key:"wysiwyg",get:function(){return this.config.wysiwyg}},{key:"openSelectionPanel",value:function(e){this.selectionPanel.dialog.manager=this,this.selectionPanel.dialog.position=e;var t=this.selectionPanel.dialog.querySelector(".js-uie-cards-container");for(var i in t.innerHTML="",this.config.uielements)if(!this.config.uielements[i].ignored&&this.config.uielements[i].enabled){var n=!0;if(this.tags.length>0)for(var r in n=!this.tagsAreExclusive,this.tags){var s=this.tags[r].replace(/^(-|\+)/,"");0<=this.config.uielements[i].tags.indexOf(s)&&(n=!this.tags[r].startsWith("-"))}n&&t.append(this.getNewUiElementCard(this.config.uielements[i],e))}this.newPanel.close(),this.selectionPanel.open()}},{key:"drawNewForm",value:function(e,t){this.newPanel.dialog.innerHTML=e;var i=this.newPanel.dialog;this.wysiwyg.load(i),this.dispatchInitFormEvent(i,this);var n=i.querySelector("form");n.manager=this,n.position=t,n.addEventListener("submit",(function(e){e.preventDefault();var t=e.currentTarget;return t.manager.submitUiElementForm(t,(function(){if(200===this.status){var e=JSON.parse(this.responseText);e.error?this.form.manager.drawNewForm(e.form_html,this.form.position):(this.form.manager.create(e.code,e.data,e.previewHtml,this.form.position),this.form.manager.newPanel.close(),this.form.manager.selectionPanel.close())}200!==this.status&&alert(this.form.manager.config.errorMessage)})),!1}));var r=i.querySelector(".js-uie-cancel");r.panel=this.newPanel,r.addEventListener("click",(function(e){e.currentTarget.panel.close()}));var s=i.querySelector(".js-uie-save");s.panel=this.newPanel,s.addEventListener("click",(function(e){e.currentTarget.panel.dialog.querySelector("form").dispatchEvent(new Event("submit",{cancelable:!0}))}))}},{key:"openNewPanel",value:function(e,t,i){this.newPanel.dialog.manager=this,this.newPanel.dialog.position=i,this.drawNewForm(e,i),this.newPanel.open()}},{key:"editUiElement",value:function(e){this.loadUiElementEditForm(e,(function(t){if(200===this.status){var i=JSON.parse(this.responseText);e.manager.openEditPanel(i.form_html,e)}}))}},{key:"drawEditForm",value:function(e,t){this.editPanel.dialog.querySelector(".js-uie-content").innerHTML=e;var i=this.editPanel.dialog;this.wysiwyg.load(i),this.dispatchInitFormEvent(i,this);var n=i.querySelector("form");n.manager=this,n.uiElement=t,n.addEventListener("submit",(function(e){e.preventDefault();var t=e.currentTarget;return t.manager.submitUiElementForm(t,(function(){if(200===this.status){var e=JSON.parse(this.responseText);e.error?this.form.manager.drawEditForm(e.form_html,this.form.uiElement):(this.form.uiElement.data=e.data,this.form.uiElement.previewHtml=e.previewHtml,this.form.manager.write(),this.form.manager.editPanel.close())}200!==this.status&&alert(this.config.errorMessage)})),!1}));var r=i.querySelector(".js-uie-cancel");r.panel=this.editPanel,r.addEventListener("click",(function(e){e.currentTarget.panel.close()}));var s=i.querySelector(".js-uie-save");s.panel=this.editPanel,s.addEventListener("click",(function(e){e.currentTarget.panel.dialog.querySelector("form").dispatchEvent(new Event("submit",{cancelable:!0}))}))}},{key:"openEditPanel",value:function(e,t){this.editPanel.dialog.manager=this,this.editPanel.dialog.uiElement=t,this.drawEditForm(e,t),this.editPanel.open()}},{key:"write",value:function(){this.input.value=this.uiElements.length>0?JSON.stringify(this.uiElements):"",this.drawUiElements(),document.dispatchEvent(new CustomEvent("mbiz:rich-editor:write-complete",{detail:{editorManager:this}}))}},{key:"create",value:function(e,t,i,n){var r=new MonsieurBizRichEditorUiElement(this.config,e,t,i);return this.uiElements.splice(n,0,r),this.write(),r}},{key:"moveUp",value:function(e){var t=this.uiElements.indexOf(e);0!==t&&(this.uiElements.splice(t,1),this.uiElements.splice(t-1,0,e),this.write())}},{key:"moveDown",value:function(e){var t=this.uiElements.indexOf(e);t!==this.uiElements.length-1&&(this.uiElements.splice(t,1),this.uiElements.splice(t+1,0,e),this.write())}},{key:"delete",value:function(e){var t=this.uiElements.indexOf(e);this.uiElements.splice(t,1),this.write()}},{key:"loadUiElementCreateForm",value:function(e,t){var i=new XMLHttpRequest;i.onload=t;var n=this.config.createElementFormUrl;i.open("get",n.replace("__CODE__",e.code),!0),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.send()}},{key:"loadUiElementEditForm",value:function(e,t){var i=new XMLHttpRequest;i.onload=t;var n=this.config.editElementFormUrl;i.open("post",n.replace("__CODE__",e.code),!0),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(new URLSearchParams({data:JSON.stringify(e.data)}).toString())}},{key:"submitUiElementForm",value:function(e,t){var i=new XMLHttpRequest;i.onload=t,i.form=e,i.open("post",e.action,!0),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.send(new FormData(e))}},{key:"requestUiElementsHtml",value:function(e,t){var i=new XMLHttpRequest;i.onload=t,i.open("post",this.config.renderElementsUrl,!0),i.setRequestHeader("X-Requested-With","XMLHttpRequest");var n=new FormData;n.append("ui_elements",JSON.stringify(e)),this.input.dataset.locale&&n.append("locale",this.input.dataset.locale),i.uiElements=e,i.manager=this,i.send(n)}},{key:"isClipboardEmpty",value:function(){var e=window.localStorage.getItem("monsieurBizRichEditorClipboard");return null===e||""===e}},{key:"saveUiElementToClipboard",value:function(e,t){window.localStorage.setItem("monsieurBizRichEditorClipboard",JSON.stringify(e)),t(),document.dispatchEvent(new CustomEvent("mbiz:rich-editor:uielement:copied",{}))}},{key:"pasteUiElementFromClipboard",value:function(e){var t=window.localStorage.getItem("monsieurBizRichEditorClipboard");if(null!==t){var i=JSON.parse(t),n=this;n.requestUiElementsHtml([i],(function(){if(200===this.status){var t=JSON.parse(this.responseText).shift();void 0===i.code&&void 0!==i.type&&(i.code=i.type,i.data=i.fields,delete i.type,delete i.fields);var r=n.config.findUiElementByCode(i.code);if(null!==r)if(n.tags.length>0){var s=!1;for(var o in n.tags)0<=n.config.uielements[r.code].tags.indexOf(n.tags[o])&&(s=!0);s?n.create(r.code,i.data,t,e):alert(n.config.unallowedUiElementMessage)}else n.create(r.code,i.data,t,e)}}))}}},{key:"dispatchInitFormEvent",value:function(e,t){document.dispatchEvent(new CustomEvent("monsieurBizRichEditorInitForm",{detail:{form:e,manager:t}}))}}])}()})()})();